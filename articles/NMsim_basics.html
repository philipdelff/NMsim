<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="NMsim">
<title>NMsim basics • NMsim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="NMsim basics">
<meta property="og:description" content="NMsim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">NMsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.909</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/NMsim_basics.html">NMsim basics</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/philipdelff/NMsim/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>NMsim basics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/philipdelff/NMsim/blob/HEAD/vignettes/NMsim_basics.Rmd" class="external-link"><code>vignettes/NMsim_basics.Rmd</code></a></small>
      <div class="d-none name"><code>NMsim_basics.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## library(devtools)</span></span>
<span><span class="co">## load_all("../../../../NMdata")</span></span>
<span><span class="co">## load_all()</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://philipdelff.github.io/NMsim/">NMsim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://philipdelff.github.io/NMdata/" class="external-link">NMdata</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; NMdata 0.1.0. Browse NMdata documentation at</span></span>
<span><span class="co">#&gt; https://philipdelff.github.io/NMdata/</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:data.table':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     between, first, last</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tracee</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">this.script</span> <span class="op">&lt;-</span> <span class="st">"NMsim_basics.Rmd"</span></span>
<span><span class="va">writeOutput</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">file.project</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>,package<span class="op">=</span><span class="st">"NMsim"</span><span class="op">)</span>,<span class="va">...</span><span class="op">)</span></span>
<span><span class="va">found.files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu">file.project</span><span class="op">(</span><span class="st">"nonmem/NMsim"</span><span class="op">)</span>,pattern<span class="op">=</span><span class="st">"noname\\.(lst|xml|ext|cov|cor|coi|phi|msf|msfi|msfo|tab)"</span>,full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">found.files</span><span class="op">)</span></span></code></pre></div>
<p>Built 2023-07-26 using NMsim 0.0.1.909.</p>
<div class="section level2">
<h2 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<p>This vignettes aims at enabling you to</p>
<ul>
<li><p>Use <code>NMsim</code> to simulate Nonmem models with a given
input data set</p></li>
<li><p>Distinguish between and perform three different types of
simulations: new subjects (default), typical subjects, and known
subjects</p></li>
<li><p>Configure <code>NMsim</code> to use <code>PSN</code> or methods
provided by <code>NMsim</code> to update Nonmem control stream initial
values and to run Nonmem</p></li>
<li><p>Understand pros and cons of using <code>PSN</code> vs. methods
provided by <code>NMsim</code>.</p></li>
</ul>
<!-- * Configure `NMsim` to use `PSN`'s `update_inits` or an alternative simple method provided by `NMsim` -->
</div>
<div class="section level2">
<h2 id="estimation-then-simulation">Estimation, then simulation<a class="anchor" aria-label="anchor" href="#estimation-then-simulation"></a>
</h2>
<p>The situation is like this: We collected PK and PD data on a drug
candidate. A PK model was estimated using Nonmem. We have on file model
input and output control streams (here with extensions <code>.mod</code>
and <code>.lst</code> respetively), parameter estimates
(<code>.ext</code>) and estimated random effects (<code>.phi</code>) are
available.</p>
<p>We want predict exposure in a few dosing regimens that we are
particularly interested in. These are regimens that we have not studied
in clinical trials so far, and we have decided to use population PK
simulations for this purpose.</p>
<p>The pop PK model is estimated using an ADVAN subroutine with
extravascular dosing in compartment 1 andthe central compartment is
compartment 2.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://philipdelff.github.io/NMdata/reference/NMexpandDoses.html" class="external-link">NMexpandDoses</a></span><span class="op">(</span><span class="va">dat.sim1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">regimen</span>,<span class="va">DOSE</span>,<span class="va">EVID</span>,<span class="va">AMT</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">EVID</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">EVID</span>,<span class="va">N</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'ID', 'regimen', 'DOSE', 'EVID'. You can</span></span>
<span><span class="co">#&gt; override using the `.groups` argument.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   ID, regimen, DOSE [4]</span></span></span>
<span><span class="co">#&gt;       ID regimen  DOSE    AMT   `1`   `2`</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 SD        100 <span style="text-decoration: underline;">100</span>000     1    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1 SD        100     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     2 SD        400 <span style="text-decoration: underline;">400</span>000     1    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     2 SD        400     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     3 QD        100 <span style="text-decoration: underline;">100</span>000     6    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     3 QD        100 <span style="text-decoration: underline;">200</span>000     1    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     3 QD        100     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   169</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     4 QD        400 <span style="text-decoration: underline;">400</span>000     6    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     4 QD        400 <span style="text-decoration: underline;">800</span>000     1    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     4 QD        400     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   169</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">dat.sim1</span><span class="op">)</span>,topn<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;      ROW ID TIME EVID CMT   AMT II ADDL DV MDV DOSE   dose regimen</span></span>
<span><span class="co">#&gt;   1:   1  1    0    1   1 1e+05 NA   NA NA   1  100 100 mg      SD</span></span>
<span><span class="co">#&gt;   2:   2  1    0    2   2    NA NA   NA NA   1  100 100 mg      SD</span></span>
<span><span class="co">#&gt;   3:   3  1    1    2   2    NA NA   NA NA   1  100 100 mg      SD</span></span>
<span><span class="co">#&gt;   4:   4  1    2    2   2    NA NA   NA NA   1  100 100 mg      SD</span></span>
<span><span class="co">#&gt;   5:   5  1    3    2   2    NA NA   NA NA   1  100 100 mg      SD</span></span>
<span><span class="co">#&gt;  ---                                                              </span></span>
<span><span class="co">#&gt; 390: 390  4  164    2   2    NA NA   NA NA   1  400 400 mg      QD</span></span>
<span><span class="co">#&gt; 391: 391  4  165    2   2    NA NA   NA NA   1  400 400 mg      QD</span></span>
<span><span class="co">#&gt; 392: 392  4  166    2   2    NA NA   NA NA   1  400 400 mg      QD</span></span>
<span><span class="co">#&gt; 393: 393  4  167    2   2    NA NA   NA NA   1  400 400 mg      QD</span></span>
<span><span class="co">#&gt; 394: 394  4  168    2   2    NA NA   NA NA   1  400 400 mg      QD</span></span></code></pre></div>
<p>We have put together a simulation data set. We used the
<code>NMcreateDoses</code> and <code>addEVID2</code> functions from
<code>NMsim</code> to do so, but that is not the topic of this vignette.
We simulate two different doses (100 mg and 400 mg) as single dose, and
then the same dose levels as QD with a double loading dose.</p>
</div>
<div class="section level2">
<h2 id="simulation-of-new-subjects">Simulation of new subjects<a class="anchor" aria-label="anchor" href="#simulation-of-new-subjects"></a>
</h2>
<p>This is the first time we are using <code>NMsim</code>, and we just
want to try the simplest thing we can think of.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## file.mod &lt;- "../nonmem/xgxr014.mod"</span></span>
<span><span class="va">file.mod</span> <span class="op">&lt;-</span> <span class="fu">file.project</span><span class="op">(</span><span class="st">"nonmem/xgxr014.mod"</span><span class="op">)</span></span>
<span><span class="va">simres</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMsim.html">NMsim</a></span><span class="op">(</span>path.mod<span class="op">=</span><span class="va">file.mod</span>,</span>
<span>                data<span class="op">=</span><span class="va">dat.sim1</span></span>
<span>                 <span class="op">)</span></span></code></pre></div>
<!-- That did not go well. As the error shows, `$TABLE` refers to a `ROW` column. Nonmem needs this to run the control stream as is. Since this does not happen until `$TABLE`, we have two options to fix it -->
<!-- - Add `ROW` to the input data set -->
<!-- - Modify `$TABLE` (using the `text.table`, demonstrated later) -->
<!-- subproblems vs repetition of input data -->
<div class="section level3">
<h3 id="more-subjects">More subjects<a class="anchor" aria-label="anchor" href="#more-subjects"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="simulation-of-multiple-models">Simulation of multiple models<a class="anchor" aria-label="anchor" href="#simulation-of-multiple-models"></a>
</h2>
<div class="section level3">
<h3 id="simulation-from-a-bootstrap">Simulation from a bootstrap<a class="anchor" aria-label="anchor" href="#simulation-from-a-bootstrap"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="simulation-of-a-typical-subject">Simulation of a typical subject<a class="anchor" aria-label="anchor" href="#simulation-of-a-typical-subject"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simres.typ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMsim.html">NMsim</a></span><span class="op">(</span>path.mod<span class="op">=</span><span class="va">file.mod</span>,</span>
<span>                    data<span class="op">=</span><span class="va">dat.sim1</span>,</span>
<span>                    type.sim<span class="op">=</span><span class="st">"typical"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulation-of-known-subjects">Simulation of known subjects<a class="anchor" aria-label="anchor" href="#simulation-of-known-subjects"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">base.sim.known</span> <span class="op">&lt;-</span> <span class="va">dat.sim.md</span><span class="op">[</span><span class="va">dat.sim.md</span><span class="op">$</span><span class="va">DOSE</span><span class="op">==</span><span class="fl">400</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">res.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://philipdelff.github.io/NMdata/reference/NMscanData.html" class="external-link">NMscanData</a></span><span class="op">(</span><span class="va">file.mod</span><span class="op">)</span></span>
<span><span class="va">idvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://philipdelff.github.io/NMdata/reference/findCovs.html" class="external-link">findCovs</a></span><span class="op">(</span><span class="va">res.mod</span>,by<span class="op">=</span><span class="st">"ID"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">dat.sim1.known</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">ids</span>,</span>
<span>                        <span class="va">base.sim.known</span><span class="op">[</span>,<span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">base.sim.known</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>                        <span class="op">)</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorder</a></span><span class="op">(</span><span class="va">dat.sim1.known</span>,<span class="va">ID</span>,<span class="va">TIME</span>,<span class="va">EVID</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res.known</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/NMsim.html">NMsim</a></span><span class="op">(</span><span class="va">file.mod</span>,</span>
<span>                   data<span class="op">=</span><span class="va">dat.sim1.known</span>,</span>
<span>                   suffix.sim<span class="op">=</span><span class="st">"known1"</span>,</span>
<span>                   text.table<span class="op">=</span><span class="st">"PRED IPRED CL V KA"</span></span>
<span>                  ,type.sim<span class="op">=</span><span class="st">"known"</span></span>
<span>                  ,path.nonmem<span class="op">=</span><span class="st">"/opt/NONMEM/nm75/run/nmfe75"</span></span>
<span>                   <span class="op">)</span></span></code></pre></div>
<p>Show a plot of the individual parameters in estimate and in sim</p>
<div class="section level3">
<h3 id="impute-simulation-times-for-building-a-pkpd-dataset">Impute simulation times for building a PK/PD dataset<a class="anchor" aria-label="anchor" href="#impute-simulation-times-for-building-a-pkpd-dataset"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="add-residual-variability">Add residual variability<a class="anchor" aria-label="anchor" href="#add-residual-variability"></a>
</h2>
</div>
<div class="section level2">
<h2 id="configuration-of-how-to-execute-nonmem">Configuration of how to execute Nonmem<a class="anchor" aria-label="anchor" href="#configuration-of-how-to-execute-nonmem"></a>
</h2>
</div>
<div class="section level2">
<h2 id="other-important-arguments-to-nmsim">Other important arguments to <code>NMsim</code><a class="anchor" aria-label="anchor" href="#other-important-arguments-to-nmsim"></a>
</h2>
<!-- simres.typ$type <- "typical" -->
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Philip Delff.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
